{% extends "layout.html" %}
{% block javascript %}
    {{ super() }}
    <script type="text/javascript">
        var global_id_string = '';
        function BuildIdString() {
            // build the id string
            {% for library in libraries %}
                global_id_string += "{{ library._id }},";
            {% endfor %}
            document.write(global_id_string);
        }
        function AppendIdsToHref(link) {
            link.href += "?library_ids=" + global_id_string;
        }
    </script>
{% endblock %}
{% block page %}
    {% if libraries %}
        <!-- display library listings in a table format -->
        <table border="1">
                <tr><td>Name:</td><td>Genus:</td><td>Species:</td><td>Common:</td><td>Date Created:</td></tr>
            {% for library in libraries %}
                <tr class="table_cell">
                    <td>{{ library.name }}</td>
                    <td>{{ library.genus }}</td>
                    <td>{{ library.species }}</td>
                    <td>{{ library.common_name }}</td>
                    <td>{{ library.created }}</td>
                    <td>
                        <a href="{{ url_for( 'detail_view', library_id=library._id ) }}">detail</a>
                    {% if session['user_email'] and session['user_email'] == library.user %}
                        <a class="edit" href="{{ url_for( 'library_edit_wizard', library_id=library._id ) }}">edit</a>
                    {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </table>
    {% else %}

    {% endif %}
    <script type="text/javascript">BuildIdString();</script>
    <a href="{{url_for('index')}}">Home</a> <br />
    <a href="{{url_for('list_library_as_json')}}" onclick=AppendIdsToHref(this)>Download Returned Entries</a>
{% endblock %}